/* ============================================
   MEDIA QUERIES - TABLET (iPadOS)
   ============================================ */

@media (min-width: 768px) and (max-width: 1024px) {
    /* Hide GNOME menu items */
    .menu-bar-left,
    .menu-bar-center,
    .menu-bar-right {
        display: none;
    }

    /* Show status bar */
    .status-bar {
        display: flex;
    }

    /* Show dock as bottom bar on tablet (like mobile) */
    .dock {
        top: auto;
        bottom: 0;
        left: 0;
        right: 0;
        width: 100%;
        height: auto;
        min-height: 0;
        flex-direction: row;
        border-right: none;
        border-top: 1px solid var(--color-border);
        border-radius: 0;
        padding: var(--spacing-sm);
        justify-content: space-around;
        transform: none;
    }

    .dock-item {
        width: 52px;
        height: 52px;
        font-size: 26px;
    }

    .dock-item:hover {
        transform: none;
    }

    .dock-separator {
        display: none;
    }

    /* Active indicator at bottom for horizontal dock */
    .dock-item.active::after {
        left: 50%;
        top: auto;
        bottom: 0;
        transform: translateX(-50%);
        width: 20px;
        height: 3px;
        border-radius: 2px 2px 0 0;
    }

    .main-content {
        padding-left: 0;
    }

    /* App Grid - 4 columns */
    .app-grid {
        position: static;
        left: 0;
        grid-template-columns: repeat(4, 1fr);
        padding: var(--spacing-xl);
        gap: var(--spacing-xl);
        margin-top: 80px;
    }

    .app-icon {
        width: 100%;
    }

    .app-icon-wrapper {
        width: 80px;
        height: 80px;
        font-size: 40px;
    }

    .app-label {
        font-size: 14px;
    }

    /* Widget Container */
    .widget-container {
        display: block;
        padding: var(--spacing-xl);
    }

    .widget {
        background: var(--color-glass-light);
        -webkit-backdrop-filter: var(--glass-blur);
        backdrop-filter: var(--glass-blur);
        border-radius: var(--radius-md);
        padding: var(--spacing-lg);
        margin-bottom: var(--spacing-md);
    }

    /* Windows become modals - positioned from top, not center transform */
    .window {
        position: fixed;
        top: 60px !important;
        left: 50% !important;
        transform: translateX(-50%);
        width: 85%;
        max-width: 600px;
        min-width: 0;
        max-height: calc(100vh - 140px);
    }

    /* Hide window controls on iPad */
    .window-controls {
        display: none;
    }

    /* Mobile close button - proper touch target */
    .close-btn-mobile {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 44px;
        height: 44px;
        background: none;
        border: none;
        font-size: 20px;
        cursor: pointer;
        color: var(--color-text-light);
        margin-left: auto;
        border-radius: var(--radius-sm);
        transition: background 0.2s ease;
    }

    .close-btn-mobile:hover {
        background: rgba(233, 84, 32, 0.15);
    }

    .close-btn-mobile:active {
        background: rgba(233, 84, 32, 0.3);
    }

}

/* ============================================
   MEDIA QUERIES - MOBILE (iOS)
   ============================================ */

@media (max-width: 767px) {
    /* Hide GNOME menu items */
    .menu-bar-left,
    .menu-bar-center,
    .menu-bar-right {
        display: none;
    }

    /* Show status bar */
    .status-bar {
        display: flex;
    }

    .top-bar {
        height: 44px;
    }

    .main-content {
        padding-top: 44px;
        padding-left: 0;
        padding-right: 0;
        /* Safe area support for notch/dynamic island */
        padding-left: env(safe-area-inset-left, 0px);
        padding-right: env(safe-area-inset-right, 0px);
    }

    /* App Grid - 4 columns */
    .app-grid {
        position: static;
        grid-template-columns: repeat(4, 1fr);
        grid-template-rows: repeat(auto-fill, auto);
        padding: var(--spacing-lg);
        gap: var(--spacing-sm);
        margin-top: 16px;
        justify-items: center;
    }

    .app-icon {
        width: 80px;
        height: auto;
        min-height: 110px;
        overflow: visible !important;
        contain: none !important;
    }

    .app-icon-placeholder {
        width: 80px;
        height: auto;
        min-height: 110px;
    }

    .app-icon-wrapper {
        width: 52px;
        height: 52px;
        font-size: 26px;
    }

    .app-label {
        font-size: 11px;
        padding: 3px 8px;
        display: block !important;
        opacity: 1 !important;
        visibility: visible !important;
        color: var(--color-text-light) !important;
        width: 100%;
        text-align: center;
        z-index: 20;
        position: relative;
        transform: translateZ(0);
        text-shadow:
            0 1px 2px rgba(0, 0, 0, 0.8),
            0 0 2px rgba(0, 0, 0, 0.4);
    }

    /* Windows become full-screen */
    .window {
        position: fixed;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 64px !important;
        /* Account for mobile dock height */
        width: 100% !important;
        max-width: 100% !important;
        min-width: 0 !important;
        max-height: none !important;
        /* Subtract dock height */
        border-radius: 0;
        margin-top: 44px !important;
        transform: none !important;
        height: calc(100vh - 44px - 64px) !important;
    }

    /* Hide window controls */
    .window-controls {
        display: none;
    }

    .close-btn-mobile {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 44px;
        height: 44px;
        background: none;
        border: none;
        font-size: 18px;
        cursor: pointer;
        color: var(--color-text-light);
        margin-left: auto;
        border-radius: var(--radius-sm);
        transition: background 0.2s ease;
    }

    .close-btn-mobile:active {
        background: rgba(233, 84, 32, 0.3);
    }

    .window-header {
        height: 44px;
        padding: var(--spacing-sm) var(--spacing-md);
    }

    /* Widget Container */
    .widget-container {
        display: none;
        padding: var(--spacing-md);
    }

    .widget {
        background: var(--color-glass-light);
        -webkit-backdrop-filter: var(--glass-blur);
        backdrop-filter: var(--glass-blur);
        border-radius: var(--radius-md);
        padding: var(--spacing-md);
        margin-bottom: var(--spacing-sm);
    }

    /* Dock - Fixed at bottom */
    .dock {
        position: fixed;
        top: auto;
        bottom: 0;
        left: 0;
        right: 0;
        width: 100%;
        height: auto;
        min-height: 0;
        transform: none;
        flex-direction: row;
        border-right: none;
        border-top: 1px solid var(--color-border);
        border-radius: 0;
        padding: var(--spacing-sm);
        /* Safe area support for bottom home bar */
        padding-bottom: calc(var(--spacing-sm) + env(safe-area-inset-bottom));
        justify-content: space-around;
        z-index: var(--z-dock); /* Use CSS variable for consistency */
    }

    .dock-item {
        width: 48px;
        height: 48px;
        font-size: 24px;
    }

    .dock-item:hover {
        transform: none;
    }

    .dock-separator {
        display: none;
    }

    /* Active indicator at bottom for horizontal dock */
    .dock-item.active::after {
        left: 50%;
        top: auto;
        bottom: 0;
        transform: translateX(-50%);
        width: 20px;
        height: 3px;
        border-radius: 2px 2px 0 0;
    }

    /* Mobile dock bounce effect */
    .dock-item:active {
        animation: dockBounce 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    /* Active app glow indicator on mobile dock */
    .dock-item.active {
        box-shadow: 0 0 12px rgba(233, 84, 32, 0.5);
    }

    /* Widget polish */
    .widget {
        border-radius: var(--radius-lg);
        border: 1px solid var(--color-border);
        margin: var(--spacing-md);
        box-shadow: var(--shadow-md);
    }

    .widget h3 {
        font-size: 16px;
        font-weight: 600;
        margin-bottom: var(--spacing-xs);
    }

    .widget p {
        font-size: 14px;
        opacity: 0.9;
    }

    /* Contact item touch targets */
    .contact-item {
        padding: var(--spacing-md);
        min-height: 56px;
        border-radius: var(--radius-sm);
        background: var(--color-card-bg);
        margin-bottom: var(--spacing-sm);
    }

    .contact-item i {
        font-size: 20px;
        width: 32px;
    }

    /* Better touch targets for social links */
    .social-link {
        min-height: 80px;
        padding: var(--spacing-md);
    }

    /* Improve project card touch feedback */
    .project-card {
        transition:
            transform 0.15s ease,
            box-shadow 0.15s ease;
    }

    .project-card:active {
        transform: scale(0.98);
    }

    /* Make tech badges more tappable */
    .tech-badge {
        padding: 6px 12px;
        font-size: 11px;
    }

    /* Hide sticky notes on mobile */
    .sticky-notes-container {
        display: none;
    }

    /* Larger touch targets for mobile dock */
    .dock-item {
        width: 54px;
        height: 54px;
        font-size: 26px;
    }
}

/* Very small screens - stack links */
@media (max-width: 400px) {
    .links-list {
        grid-template-columns: 1fr;
    }

    .skills-grid {
        grid-template-columns: 1fr;
    }
}

/* Better grid spacing on very small screens */
@media (max-width: 380px) {
    .app-grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 6px;
        padding: var(--spacing-sm);
    }

    .app-icon {
        width: 100%;
        height: 115px;
    }

    .app-icon-wrapper {
        width: 44px;
        height: 44px;
        font-size: 22px;
    }

    .app-label {
        font-size: 10px;
        padding: 2px 4px;
        display: block !important;
        opacity: 1 !important;
        visibility: visible !important;
        color: var(--color-text-light) !important;
    }
}

/* Hide sticky notes on tablet too */
@media (max-width: 1024px) {
    .sticky-notes-container {
        display: none;
    }

    /* Override desktop dock min-height for horizontal layout */
    .dock {
        min-height: 0 !important;
    }

    /* Show terminal submit button on mobile/tablet */
    .terminal-submit-btn {
        display: flex;
    }

    /* Improve terminal input line for mobile */
    .terminal-input-line {
        padding: var(--spacing-sm);
        background: rgba(0, 0, 0, 0.3);
        border-radius: var(--radius-sm);
        margin-top: var(--spacing-sm);
    }

    /* Mobile/Tablet: tooltips appear above */
    .dock-tooltip {
        left: 50%;
        top: auto;
        bottom: calc(100% + 12px);
        transform: translateX(-50%);
    }

    .dock-tooltip::before {
        right: auto;
        left: 50%;
        top: 100%;
        transform: translateX(-50%);
        border: 6px solid transparent;
        border-top-color: var(--color-window-body-bg);
    }
}

/* Shorten prompt on very small screens */
@media (max-width: 480px) {
    .terminal-prompt {
        font-size: 12px;
    }

    .terminal-input {
        font-size: 14px;
    }

    .app-grid {
        grid-template-columns: repeat(4, 1fr);
        gap: 8px;
    }

    .app-icon {
        width: 70px;
        height: 115px;
    }

    .app-icon-placeholder {
        width: 70px;
        height: 115px;
    }

    .app-icon-wrapper {
        width: 48px;
        height: 48px;
        font-size: 24px;
    }

    .app-label {
        font-size: 10px;
        padding: 2px 6px;
        display: block !important;
        opacity: 1 !important;
        visibility: visible !important;
        color: var(--color-text-light) !important;
    }

    /* Links grid - 2 columns on mobile, stacked on very small */
    .links-list {
        grid-template-columns: repeat(2, 1fr);
        gap: var(--spacing-sm);
    }

    /* Skills grid - 2 columns */
    .skills-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: var(--spacing-sm);
    }

    /* Compact skill cards on mobile */
    .skill-card {
        padding: var(--spacing-sm);
    }

    .skill-icon {
        font-size: 24px;
        margin-bottom: 4px;
    }

    .skill-card h4 {
        font-size: 13px;
        margin-bottom: 4px;
    }

    .skill-card p {
        font-size: 11px;
        line-height: 1.3;
    }
}

/* ============================================
   DESKTOP SPECIFIC (GNOME)
   ============================================ */

@media (min-width: 1025px) {
    /* App grid positioned in 2 columns */
    .app-grid {
        grid-template-columns: repeat(2, 100px);
    }

    /* Windows can be positioned anywhere */
    .window {
        top: 15%;
        left: calc(var(--dock-width) + 10%);
    }
}

/* Tablet Layout (768px - 1024px) */
@media screen and (min-width: 768px) and (max-width: 1024px) {
    .app-grid {
        left: calc(var(--dock-width) + 10px);
        right: 10px;
        top: 50px;
        grid-template-columns: repeat(auto-fill, 90px);
        grid-template-rows: repeat(auto-fill, 100px);
        gap: var(--spacing-sm);
    }

    .app-icon {
        width: 90px;
        height: 100px;
    }

    .app-icon-placeholder {
        width: 90px;
        height: 100px;
    }

    .app-icon-wrapper {
        width: 56px;
        height: 56px;
        font-size: 28px;
    }
}

/* Mobile Layout grid updates (projects grid) */
@media screen and (max-width: 767px) {
    /* Projects grid - single column on mobile */
    .projects-grid {
        grid-template-columns: 1fr;
    }

    /* Featured project takes full width */
    .project-card.featured-project {
        grid-column: 1;
    }
}

/* ============================================
   PERFORMANCE - MOBILE GPU OPTIMIZATION
   ============================================ */

/* Disable heavy GPU effects on mobile/tablet for smoother performance */
@media (max-width: 1024px) {
    .wallpaper::after {
        /* Disable noise grain texture on mobile for GPU savings */
        display: none;
    }

    .wallpaper::before {
        /* Simplify radial gradients on mobile */
        opacity: 0.5;
    }
}

/* ============================================
   ACCESSIBILITY - REDUCED MOTION
   ============================================ */

@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }

    .wallpaper {
        transform: none !important;
        transition: none !important;
    }

    .app-icon,
    .dock-item,
    .window,
    .sticky-note {
        animation: none !important;
    }

    .skill-progress-bar {
        transition: none !important;
        width: var(--progress) !important;
    }
}

/* ============================================
   iOS SAFE AREA INSETS
   ============================================ */

@supports (padding-bottom: env(safe-area-inset-bottom)) {
    @media (max-width: 1024px) {
        /* Dock accounts for home indicator */
        .dock {
            padding-bottom: calc(var(--spacing-sm) + env(safe-area-inset-bottom));
        }

        /* Windows account for safe areas */
        .window {
            padding-bottom: env(safe-area-inset-bottom);
        }

        /* Full-screen mobile windows */
        @media (max-width: 767px) {
            .window {
                bottom: calc(64px + env(safe-area-inset-bottom));
                max-height: calc(100% - 64px - env(safe-area-inset-bottom));
            }
        }
    }
}
